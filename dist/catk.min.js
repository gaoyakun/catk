!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Catk={})}(this,function(t){"use strict";var e=function(){function t(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}return t.getIdentity=function(){return new t},t.getTranslate=function(e,n){return(new t).makeTranslate(e,n)},t.getScale=function(e,n){return(new t).makeScale(e,n)},t.getRotate=function(e){return(new t).makeRotate(e)},t.transform=function(e,n){return(new t).copyFrom(e).transform(n)},t.translate=function(e,n,r){return(new t).copyFrom(e).translate(n,r)},t.scale=function(e,n,r){return(new t).copyFrom(e).scale(n,r)},t.rotate=function(e,n){return(new t).copyFrom(e).rotate(n)},t.invert=function(e){return(new t).copyFrom(e).invert()},t.prototype.set=function(t,e,n,r,i,o){return this.a=t,this.b=e,this.c=n,this.d=r,this.e=i,this.f=o,this},t.prototype.makeIdentity=function(){return this.set(1,0,0,1,0,0)},t.prototype.makeTranslate=function(t,e){return this.set(1,0,0,1,t,e)},t.prototype.makeScale=function(t,e){return this.set(t,0,0,e,0,0)},t.prototype.makeRotate=function(t){var e=Math.sin(t),n=Math.cos(t);return this.set(n,e,-e,n,0,0)},t.prototype.copyFrom=function(t){return this.set(t.a,t.b,t.c,t.d,t.e,t.f)},t.prototype.transform=function(t){return this.set(this.a*t.a+this.c*t.b,this.b*t.a+this.d*t.b,this.a*t.c+this.c*t.d,this.b*t.c+this.d*t.d,this.a*t.e+this.c*t.f+this.e,this.b*t.e+this.d*t.f+this.f)},t.prototype.transformPoint=function(t){return{x:Math.round(this.a*t.x+this.c*t.y+this.e),y:Math.round(this.b*t.x+this.d*t.y+this.f)}},t.prototype.translate=function(e,n){return this.transform(t.getTranslate(e,n))},t.prototype.scale=function(e,n){return this.transform(t.getScale(e,n))},t.prototype.rotate=function(e){return this.transform(t.getRotate(e))},t.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,r=this.d,i=this.e,o=this.f,s=1*r-0*o,a=-1*n+0*i,c=o*n-r*i,u=t*s+e*a+0*c;return u?(u=1/u,this.a=s*u,this.b=(-1*e+0*o)*u,this.c=a*u,this.d=(1*t-0*i)*u,this.e=c*u,this.f=(-o*t+e*i)*u,this):this},t.prototype.getTranslationPart=function(){return{x:this.e,y:this.f}},t.prototype.setTranslationPart=function(t){this.e=t.x,this.f=t.y},t.prototype.getScalePart=function(){return{x:Math.sqrt(this.a*this.a+this.b*this.b),y:Math.sqrt(this.c*this.c+this.d*this.d)}},t.prototype.setScalePart=function(t){var e=this.getScalePart(),n=t.x/e.x;this.a*=n,this.b*=n;var r=t.y/e.y;this.c*=r,this.d*=r},t.prototype.getRotationPart=function(){var t=Math.sqrt(this.a*this.a+this.b*this.b);if(0===t)return 0;var e=Math.max(Math.min(this.a/t,1),-1),n=Math.max(Math.min(this.b/t,1),-1),r=Math.acos(e);return n>=0?r:2*Math.PI-r},t.prototype.setRotationPart=function(t){var e=this.getScalePart(),n=Math.sin(t),r=Math.cos(t);this.a=e.x*r,this.b=e.x*n,this.c=-e.y*n,this.d=e.y*r},t}();function n(t){return{x:t.x,y:t.y}}function r(t){return{x:t.x+t.w,y:t.y}}function i(t){return{x:t.x,y:t.y+t.h}}function o(t){return{x:t.x+t.w,y:t.y+t.h}}function s(t){return t.x*t.x+t.y*t.y}function a(t){return Math.sqrt(s(t))}function c(t,e){return s(l(t,e))}function u(t,e){return t.x*e.x+t.y*e.y}function h(t,e){return t.x*e.y-t.y*e.x}function l(t,e){return{x:e.x-t.x,y:e.y-t.y}}function p(t,e,n){return{x:Math.max(e.x,Math.min(n.x,t.x)),y:Math.max(e.y,Math.min(n.y,t.y))}}var f,g=function(){return function(t){this.type=t}}(),y=(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(n){var r=t.call(this,e.type)||this;return r._points=n||[],r._boundingbox=null,r._dirtyFlag=r._points.length>0,r}return y(e,t),e.prototype.addPoint=function(t){this._points.push(t),this._dirtyFlag=!0},Object.defineProperty(e.prototype,"length",{get:function(){return this._points.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boundingbox",{get:function(){return this._checkDirty(),this._boundingbox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"points",{get:function(){return this._checkDirty(),this._points},enumerable:!0,configurable:!0}),e.prototype.getPoint=function(t){return this._checkDirty(),this._points[t]},e.prototype.removePoint=function(t){this._points.splice(t,1),0===this._points.length?(this._boundingbox=null,this._dirtyFlag=!1):this._dirtyFlag=!0},e.prototype.clear=function(){this._points.length=0,this._boundingbox=null,this._dirtyFlag=!1},e.prototype.getBoundingbox=function(){return this.boundingbox},e.prototype.getTransformedShape=function(t){return new e(t?this._points.map(function(e){return t.transformPoint(e)}):this._points)},e.prototype._checkDirty=function(){this._dirtyFlag&&(this._dirtyFlag=!1,this._adjustPoints(),this._computeBoundingbox())},e.prototype._adjustPoints=function(){var t=this._points.length;if(!(t<3)){for(var e=[this._points[0],this._points[1]],n=2;n<t;n++){for(var r=e.length-1;r>0;){var i=l(e[0],e[r]),o=l(e[0],this._points[n]),a=h(i,o);if(a<0){e.splice(r+1,0,this._points[n]);break}if(0===a&&s(o)>s(i)){e.splice(r+1,0,this._points[n]);break}r--}0===r&&e.splice(1,0,this._points[n])}this._points=e}},e.prototype._computeBoundingbox=function(){if(this._points.length>0){var t=this._points[0].x,e=this._points[0].y,n=t,r=e;this._points.forEach(function(i){var o=i.x,s=i.y;o<t?t=o:o>n&&(n=o),s<e?e=s:s>r&&(r=s)}),this._boundingbox={x:t,y:e,w:n-t+1,h:r-e+1}}else this._boundingbox=null},e.type="Hull",e}(g),v=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=function(t){function e(n){var r=t.call(this,e.type)||this;return r.rect=n||null,r}return v(e,t),e.prototype.getBoundingbox=function(){return this.rect},e.prototype.getTransformedShape=function(t){if(null===this.rect)return null;if(t){var n={x:this.rect.x,y:this.rect.y},r={x:this.rect.x,y:this.rect.y+this.rect.h-1},i={x:this.rect.x+this.rect.w-1,y:this.rect.y+this.rect.h-1},o={x:this.rect.x+this.rect.w-1,y:this.rect.y};return new d([t.transformPoint(n),t.transformPoint(r),t.transformPoint(i),t.transformPoint(o)])}return new e(this.rect)},e.type="Box",e}(g),b=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=function(t){function e(n){void 0===n&&(n=null);var r=t.call(this,e.type)||this;return r._segment=n,r._dirty=!!n,r._boundingbox=null,r}return b(e,t),Object.defineProperty(e.prototype,"start",{get:function(){return this._segment?this._segment.start:null},set:function(t){this._segment?this._segment.start=t:this._segment={start:t,end:t},this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._segment?this._segment.end:null},set:function(t){this._segment?this._segment.end=t:this._segment={start:t,end:t},this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segment",{get:function(){return{start:this.start,end:this.end}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boundingbox",{get:function(){return this._checkDirty(),this._boundingbox},enumerable:!0,configurable:!0}),e.prototype.getBoundingbox=function(){return this.boundingbox},e.prototype.getTransformedShape=function(t){return t&&this._segment?new e({start:t.transformPoint(this._segment.start),end:t.transformPoint(this._segment.end)}):new e(this._segment)},e.prototype._checkDirty=function(){if(this._dirty){this._dirty=!1;var t=this._segment.start.x,e=this._segment.start.y,n=this._segment.end.x,r=this._segment.end.y;if(t>n){var i=t;t=n,n=i}if(e>r){i=e;e=r,r=i}this._boundingbox={x:t,y:e,w:n-t+1,h:r-e+1}}},e.type="Segment",e}(g),k=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=function(t){function e(n){void 0===n&&(n=null);var r=t.call(this,e.type)||this;return r.sphere=n,r}return k(e,t),Object.defineProperty(e.prototype,"center",{get:function(){return this._sphere?this._sphere.center:null},set:function(t){this._sphere?this._sphere.center=t:this._sphere={center:t,radius:1},this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this._sphere?this._sphere.radius:null},set:function(t){this._sphere?this._sphere.radius=t:this._sphere={center:{x:0,y:0},radius:t},this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sphere",{get:function(){return this._sphere?{center:this._sphere.center,radius:this._sphere.radius}:null},set:function(t){this._sphere=t||null,this._dirty=!!t,this._boundingbox=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boundingbox",{get:function(){return this._checkDirty(),this._boundingbox},enumerable:!0,configurable:!0}),e.prototype.getBoundingbox=function(){return this.boundingbox},e.prototype.getTransformedShape=function(t){if(t&&this._sphere){for(var n=.125*Math.PI,r=2*n,i=this._sphere.radius/Math.cos(n),o=new d,s=n;s<2*Math.PI;s+=r){var a=t.transformPoint({x:i*Math.cos(s),y:i*Math.sin(s)});a.x=Math.round(a.x),a.y=Math.round(a.y),o.addPoint(a)}return o}return new e(this._sphere)},e.prototype._checkDirty=function(){this._dirty&&(this._dirty=!1,this._boundingbox={x:this._sphere.center.x-this._sphere.radius+1,y:this._sphere.center.y-this._sphere.radius+1,w:2*this._sphere.radius-1,h:2*this._sphere.radius-1})},e.type="sphere",e}(g);function x(t,e){if(!O(t.getBoundingbox(),e))return!1;switch(t.type){case m.type:return!0;case d.type:return C(t.points,e);case _.type:return K(t.segment,e);case w.type:return V(t.sphere,e);default:return!1}}function P(t,e){return t.x<=e.x+e.w&&t.x+t.w>=e.x&&t.y<=e.y+e.h&&t.y+t.h>=e.y}function O(t,e){return e.x>=t.x&&e.x<=t.x+t.w&&e.y>=t.y&&e.y<=t.y+t.h}function T(t,e){return L([n(t),i(t),o(t),r(t)],e)}function E(t,e){return M([n(t),i(t),o(t),r(t)],e)}function j(t,e){var n=l(p(e.center,{x:t.x,y:t.y},{x:t.x+t.w-1,y:t.y+t.h-1}),e.center);return u(n,n)<e.radius*e.radius}function S(t,e){for(var n=t.radius*t.radius,r=0;r<e.length;r++){var i=t.center.x-e[r].x,o=t.center.y-e[r].y;if(i*i+o*o<n)return!0}for(r=0;r<e.length;r++){var s=D(t,{start:e[r],end:e[(r+1)%e.length]});if(null!==s&&s.length>0)return!0}return C(e,t.center)}function C(t,e){for(var n=0;n<t.length;n++){if(h(l(e,t[n]),l(e,t[(n+1)%t.length]))>0)return!1}return!0}function I(t,e){var n=t.center.x-e.center.x,r=t.center.y-e.center.y,i=t.radius+e.radius;return n*n+r*r<i*i}function D(t,e){var n=l(e.start,e.end),r=l(t.center,e.start),i=u(n,n),o=2*u(r,n),s=o*o-4*i*(u(r,r)-t.radius*t.radius);if(s<0)return null;var a=(-o-(s=Math.sqrt(s)))/(2*i),c=(-o+s)/(2*i);if(a>c){var h=a;a=c,c=h}var p=[];return a>=0&&a<=1&&p.push({x:e.start.x+a*n.x,y:e.start.y+a*n.y}),c>=0&&c<=1&&p.push({x:e.start.x+c*n.x,y:e.start.y+c*n.y}),p}function M(t,e){if(C(t,e.start)&&C(t,e.end))return[];for(var n=[],r=0;r<t.length;r++){var i=A({start:t[r],end:t[(r+1)%t.length]},e);i&&n.push(i)}return n.length>1&&n.sort(function(t,n){return c(t,e.start)-c(n,e.start)}),n.length>0?n:null}function L(t,e){for(var n=[t,e],r=0;r<2;r++)for(var i=n[r],o=function(t){var e=i[(t+1)%i.length].x-i[t].x,r=i[(t+1)%i.length].y-i[t].y,o=Math.sqrt(e*e+r*r);if(o<1)return"continue";for(var s=-r/o,a=e/o,c=[{min:9999999,max:-9999999},{min:9999999,max:-9999999}],u=function(t){n[t].forEach(function(e){var n=e.x*s+e.y*a;n<c[t].min&&(c[t].min=n),n>c[t].max&&(c[t].max=n)})},h=0;h<2;h++)u(h);return c[0].min>c[1].max||c[0].max<c[1].min?{value:!1}:void 0},s=0;s<i.length;s++){var a=o(s);if("object"==typeof a)return a.value}return!0}function V(t,e){var n=t.center.x-e.x,r=t.center.y-e.y;return n*n+r*r<t.radius*t.radius}function K(t,e){var n=t.start.x,r=t.start.y,i=t.end.x,o=t.end.y;if(n>i){var s=n;n=i,i=s}if(r>o){s=r;r=o,o=s}if(e.x<n||e.x>i||e.y<r||e.y>o)return!1;if(i!==n){var a=Math.round(r+(o-r)*(e.x-n)/(i-n))-e.y;return a>=-1&&a<=1}if(o!==r){var c=Math.round(n+(i-n)*(e.y-r)/(o-r))-e.x;return c>=-1&&c<=1}return e.x===n&&e.y===r}function A(t,e){function n(t,e){return t>=0&&e>=0||t<=0&&e<=0}var r,i,o,s,a,c=t.start.x,u=t.start.y,h=t.end.x,l=t.end.y,p=e.start.x,f=e.start.y,g=e.end.x,y=e.end.y,d=h-c,v=p-g;if(d<0?(r=h,i=c):(i=h,r=c),v>0){if(i<g||p<r)return null}else if(i<p||g<r)return null;var m=l-u,b=f-y;if(m<0?(o=l,s=u):(s=l,o=u),b>0){if(s<y||f<o)return null}else if(s<f||y<o)return null;var _=c-p,k=u-f,w=m*v-d*b;if(0===w)return null;var x=b*_-v*k;if(w>0){if(x<0||x>w)return null}else if(x>0||x<w)return null;var P=d*k-m*_;if(w>0){if(P<0||P>w)return null}else if(P>0||P<w)return null;return{x:c+(((a=x*d)+(n(a,w)?w/2:-w/2))/w>>0),y:u+(((a=x*m)+(n(a,w)?w/2:-w/2))/w>>0)}}var R,F=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();(R=t.EventListenerOrder||(t.EventListenerOrder={}))[R.FIRST=1]="FIRST",R[R.LAST=2]="LAST";var B=function(){function t(t){this.type=t,this.eaten=!1}return t.prototype.eat=function(){this.eaten=!0},t}(),z=function(t){function e(n){var r=t.call(this,e.type)||this;return r.object=n,r.allow=!0,r}return F(e,t),e.type="@componentBeforeAttach",e}(B),N=function(t){function e(){return t.call(this,e.type)||this}return F(e,t),e.type="@componentAttached",e}(B),H=function(t){function e(){var n=t.call(this,e.type)||this;return n.allow=!0,n}return F(e,t),e.type="@componentBeforeDetach",e}(B),U=function(t){function e(){return t.call(this,e.type)||this}return F(e,t),e.type="@componentDetached",e}(B),W=function(t){function e(n,r,i){var o=t.call(this,e.type)||this;return o.deltaTime=n,o.elapsedTime=r,o.frameStamp=i,o}return F(e,t),e.type="@update",e}(B),Y=function(t){function e(n,r){var i=t.call(this,e.type)||this;return i.canvasWidth=n,i.canvasHeight=r,i.result={},i}return F(e,t),e.prototype.addObject=function(t,e,n){var r=this.result[e]||[];r.push({object:t,z:e,transform:n}),this.result[e]=r},e.type="@cull",e}(B),X=function(t){function e(n,r,i){var o=t.call(this,e.type)||this;return o.canvas=n,o.z=r,o.transform=i,o}return F(e,t),e.type="@draw",e}(B),q=function(t){function e(n,r){var i=t.call(this,e.type)||this;return i.x=n,i.y=r,i.result=!1,i}return F(e,t),e.type="@hittest",e}(B),G=function(t){function e(){return t.call(this,e.type)||this}return F(e,t),e.type="@getboundingshape",e}(B),Q=function(t){function e(n,r,i){var o=t.call(this,e.type)||this;return o.deltaTime=n,o.elapsedTime=r,o.frameStamp=i,o}return F(e,t),e.type="@frame",e}(B),Z=function(t){function e(n){var r=t.call(this,e.type)||this;return r.focus=n,r}return F(e,t),e.type="@focus",e}(B),J=function(t){function e(e,n,r,i,o,s,a){var c=t.call(this,e)||this;return c.key=n,c.keyCode=r,c.shiftDown=i,c.altDown=o,c.ctrlDown=s,c.metaDown=a,c}return F(e,t),e}(B),$=function(t){function e(n,r,i,o,s,a){return t.call(this,e.type,n,r,i,o,s,a)||this}return F(e,t),e.type="@keydown",e}(J),tt=function(t){function e(n,r,i,o,s,a){return t.call(this,e.type,n,r,i,o,s,a)||this}return F(e,t),e.type="@keyup",e}(J),et=function(t){function e(n,r,i,o,s,a){return t.call(this,e.type,n,r,i,o,s,a)||this}return F(e,t),e.type="@keypress",e}(J),nt=function(t){function e(e,n,r,i,o,s,a,c){var u=t.call(this,e)||this;return u.x=n,u.y=r,u.button=i,u.shiftDown=o,u.altDown=s,u.ctrlDown=a,u.metaDown=c,u.bubble=!0,u}return F(e,t),e.prototype.cancelBubble=function(){this.bubble=!1},e}(B),rt=function(t){function e(n,r,i,o,s,a,c){return t.call(this,e.type,n,r,i,o,s,a,c)||this}return F(e,t),e.type="@mousedown",e}(nt),it=function(t){function e(n,r,i,o,s,a,c){return t.call(this,e.type,n,r,i,o,s,a,c)||this}return F(e,t),e.type="@mouseup",e}(nt),ot=function(t){function e(n,r,i,o,s,a,c){return t.call(this,e.type,n,r,i,o,s,a,c)||this}return F(e,t),e.type="@mousemove",e}(nt),st=function(t){function e(){return t.call(this,e.type)||this}return F(e,t),e.type="@mouseenter",e}(B),at=function(t){function e(){return t.call(this,e.type)||this}return F(e,t),e.type="@mouseleave",e}(B),ct=function(t){function e(n,r,i,o,s,a,c){return t.call(this,e.type,n,r,i,o,s,a,c)||this}return F(e,t),e.type="@click",e}(nt),ut=function(t){function e(n,r,i,o,s,a,c){return t.call(this,e.type,n,r,i,o,s,a,c)||this}return F(e,t),e.type="@dblclick",e}(nt),ht=function(t){function e(n,r,i,o,s,a,c){var u=t.call(this,e.type,n,r,i,o,s,a,c)||this;return u.data=null,u}return F(e,t),e.type="@dragbegin",e}(nt),lt=function(t){function e(n,r,i,o,s,a,c,u){var h=t.call(this,e.type,n,r,i,o,s,a,c)||this;return h.data=u,h}return F(e,t),e.type="@dragend",e}(nt),pt=function(t){function e(n,r,i,o,s,a,c,u){var h=t.call(this,e.type,n,r,i,o,s,a,c)||this;return h.data=u,h}return F(e,t),e.type="@dragging",e}(nt),ft=function(t){function e(n,r,i,o,s,a,c,u,h){var l=t.call(this,e.type,n,r,i,o,s,a,c)||this;return l.object=u,l.data=h,l}return F(e,t),e.type="@dragover",e}(nt),gt=function(t){function e(n,r,i,o,s,a,c,u,h){var l=t.call(this,e.type,n,r,i,o,s,a,c)||this;return l.object=u,l.data=h,l}return F(e,t),e.type="@dragdrop",e}(nt),yt=function(t){function e(){return t.call(this,e.type)||this}return F(e,t),e.type="@resize",e}(B),dt=function(t){function e(n){var r=t.call(this,e.type)||this;return r.view=n,r}return F(e,t),e.type="@canvasresize",e}(B),vt=function(t){function e(n){var r=t.call(this,e.type)||this;return r.propName=n,r.propValue=void 0,r}return F(e,t),e.type="@getprop",e}(B),mt=function(t){function e(n,r){var i=t.call(this,e.type)||this;return i.propName=n,i.propValue=r,i}return F(e,t),e.type="@setprop",e}(B),bt=function(t){function e(n,r,i){var o=t.call(this,e.type)||this;return o.view=n,o.oldPage=r,o.newPage=i,o}return F(e,t),e.type="@scenviewpagewillchange",e}(B),_t=function(t){function e(n,r,i){var o=t.call(this,e.type)||this;return o.view=n,o.oldPage=r,o.newPage=i,o}return F(e,t),e.type="@sceneviewpagechanged",e}(B),kt=function(){function t(){}return t.isWindows=function(){return this._isWindows},t.isMac=function(){return this._isMac},t.isUnix=function(){return this._isX11&&!this._isWindows&&!this._isMac},t.isLinux=function(){return this._isLinux},t.isAndroid=function(){return this._isLinux&&this._isAndroid},t._isWindows="Win32"===navigator.platform||"Windows"===navigator.platform,t._isMac="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform,t._isX11="X11"===navigator.platform,t._isLinux=String(navigator.platform).indexOf("Linux")>=0,t._isAndroid=(navigator.userAgent.toLowerCase().match(/android/i)||[]).indexOf("android")>=0,t}(),wt=function(){function e(){}return e.prototype.on=function(e,n,r){xt.addEventListener(e,this,n,r||t.EventListenerOrder.FIRST)},e.prototype.off=function(t,e){xt.removeEventListener(t,this,e)},e.prototype.trigger=function(t){xt.triggerEvent(this,t)},e.prototype.triggerEx=function(t){this.trigger(t)},e.prototype.post=function(t){xt.postEvent(this,t)},e}(),xt=function(){function e(){}return e.postEvent=function(t,e){this.eventQueue.push({evt:e,target:t})},e.triggerEvent=function(t,e){this.processEvent(e,t)},e.processPendingEvents=function(){var t=this,e=this.eventQueue;this.eventQueue=[],e.forEach(function(e){t.processEvent(e.evt,e.target)})},e.addEventListener=function(e,n,r,i){for(var o=this.eventListeners[e]||[],s=0;s<o.length;s++)if(o[s].bindObject===n){if(i===t.EventListenerOrder.FIRST)o[s].handlers={handler:r,next:o[s].handlers};else{for(var a=o[s].handlers;a.next;)a=a.next;a.next={handler:r,next:null}}return}o.push({bindObject:n,handlers:{handler:r,next:null}}),this.eventListeners[e]=o},e.removeEventListener=function(t,e,n){for(var r=this.eventListeners[t]||[],i=0;i<r.length;i++)if(r[i].bindObject===e){if(!n){r.splice(i,1);break}for(var o=r[i].handlers,s=null;o&&o.handler!==n;)s=o,o=o.next;o&&(s?s.next=o.next:r[i].handlers=o.next),r[i].handlers||r.splice(i,1)}},e.run=function(){this.running||(this.running=!0,this.lastFrameTime=0,this.firstFrameTime=0,this.elapsedTime=0,this.deltaTime=0,this.frameStamp=0,this.init(),requestAnimationFrame(function t(n){e.running&&(0===e.lastFrameTime&&(e.lastFrameTime=n,e.firstFrameTime=n),e.deltaTime=n-e.lastFrameTime,e.elapsedTime=n-e.firstFrameTime,e.lastFrameTime=n,e.frameStamp++,e.processPendingEvents(),e.triggerEvent(null,new Q(e.deltaTime,e.elapsedTime,e.frameStamp)),e.running&&requestAnimationFrame(t))}))},e.addView=function(t){return!(!t||!t.canvas||this.findView(t.canvas.canvas))&&(this.views.push(t),this.focusView||this.setFocusView(t),!0)},e.addCanvas=function(t,e){if(!this.findView(t)){var n=new Et(t,void 0!==e&&e);return this.addView(n)?n:null}return null},e.setFocusView=function(t){this.focusView!==t&&(this.focusView&&this.focusView.trigger(new Z(!1)),this.focusView=t,this.focusView&&this.focusView.trigger(new Z(!0)))},e.findView=function(t){for(var e=0;e<this.views.length;e++)if(this.views[e].canvas.canvas===t)return this.views[e];return null},e.removeView=function(t){for(var e=0;e<this.views.length;e++)this.views[e].canvas.canvas===t&&this.views.splice(e,1)},e.setCapture=function(t){this.capturedView=t},e.init=function(){this.initEventListeners()},e.processEvent=function(t,e){var n=this.eventListeners[t.type];if(n)for(var r=0;r<n.length;r++){var i=n[r];if(!e||i.bindObject===e){for(var o=i.handlers;o&&(o.handler.call(i.bindObject,t),!t.eaten);)o=o.next;if(e)break}}},e.hitView=function(t,e){if(null!==this.capturedView)return this.capturedView;for(var n=0;n<this.views.length;n++){var r=this.views[n],i=r.canvas.viewport_rect;if(t>=i.x&&t<i.x+i.w&&e>=i.y&&e<i.y+i.h)return r}return null},e.resizeHandler=function(){var t=new yt;this.views.forEach(function(e){e.triggerEx(t)})},e.mouseDownHandler=function(t){this.clickTick=Date.now();var e=this.hitView(t.clientX,t.clientY);null!==e&&e.handleMouseDown(t)},e.mouseUpHandler=function(t){var e=this.hitView(t.clientX,t.clientY);if(null!==e){var n=Date.now();n<this.clickTick+this.clickTime?n<this.dblClickTick+this.dblclickTime?(e.handleDblClick(t),this.dblClickTick=0):(e.handleClick(t),this.dblClickTick=n):this.dblClickTick=0,e.handleMouseUp(t),this.clickTick=0}else this.clickTick=0,this.dblClickTick=0},e.mouseMoveHandler=function(t){var e=this.hitView(t.clientX,t.clientY);if(e!==this.hoverView&&(this.hoverView&&(this.hoverView.triggerEx(new at),this.hoverView=null),null!==e&&(this.hoverView=e,e.triggerEx(new st))),null!==e){var n=e.canvas.viewport_rect;e.updateHitObjects(t.clientX-n.x,t.clientY-n.y),e.handleMouseMove(t)}},e.keyDownHandler=function(t){this.focusView&&this.focusView.trigger(new $(t.key,t.keyCode,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey))},e.keyUpHandler=function(t){this.focusView&&this.focusView.trigger(new tt(t.key,t.keyCode,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey))},e.keyPressHandler=function(t){this.focusView&&this.focusView.trigger(new et(t.key,t.keyCode,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey))},e.initEventListeners=function(){window.addEventListener("resize",this.resizeHandler.bind(this)),window.addEventListener(window.onpointerdown?"pointerdown":"mousedown",this.mouseDownHandler.bind(this)),window.addEventListener(window.onpointerup?"pointerup":"mouseup",this.mouseUpHandler.bind(this)),window.addEventListener(window.onpointermove?"pointermove":"mousemove",this.mouseMoveHandler.bind(this)),window.addEventListener("keydown",this.keyDownHandler.bind(this)),window.addEventListener("keyup",this.keyUpHandler.bind(this)),window.addEventListener("keypress",this.keyPressHandler.bind(this))},e.elapsedTime=0,e.deltaTime=0,e.eventQueue=[],e.eventListeners={},e.running=!1,e.lastFrameTime=0,e.firstFrameTime=0,e.frameStamp=0,e.capturedView=null,e.hoverView=null,e.focusView=null,e.views=[],e.clickTick=0,e.dblClickTick=0,e.clickTime=400,e.dblclickTime=400,e}(),Pt=function(t){function e(e){var n=t.call(this)||this;return n.type=e,n.object=null,n}return F(e,t),e.prototype.toString=function(){return"<Component: "+this.type+">"},e}(wt),Ot=function(t){function e(){var e=t.call(this)||this;return e.components={},e}return F(e,t),e.prototype.toString=function(){return"<BaseObject>"},e.prototype.addComponent=function(t){if(null===t.object){var e=this.components[t.type]||[];if(e.indexOf(t)<0){var n=new z(this);t.trigger(n),n.object=null,n.allow&&(e.push(t),t.object=this,t.trigger(new N))}this.components[t.type]=e}return this},e.prototype.removeComponent=function(t){if(t.object===this){var e=this.components[t.type].indexOf(t);this.removeComponentByIndex(t.type,e)}return this},e.prototype.removeComponentByIndex=function(t,e){var n=this.components[t];if(n&&e>=0&&e<n.length){var r=new H;n[e].trigger(r),r.allow&&(n[e].trigger(new U),n[e].object=null,n.splice(e,1))}return this},e.prototype.removeComponentsByType=function(t){for(var e=this.components[t];e&&e.length>0;)this.removeComponentByIndex(t,e.length-1);return this},e.prototype.removeAllComponents=function(){var t=this;return Object.keys(this.components).forEach(function(e){t.removeComponentsByType(e)}),this},e.prototype.getComponent=function(t,e){void 0===e&&(e=0);var n=this.components[t];return void 0===n||e<0||n.length<=e?null:n[e]},e.prototype.getComponents=function(t){return this.components[t]},e.prototype.triggerEx=function(e){for(var n in t.prototype.trigger.call(this,e),this.components)this.components.hasOwnProperty(n)&&this.components[n].forEach(function(t){t.trigger(e)})},e.prototype.post=function(t){xt.postEvent(this,t)},e}(wt),Tt=function(t){function n(n){void 0===n&&(n=null);var r=t.call(this)||this;return r._view=null,r._parent=null,r._z=0,r._visible=!0,r._children=[],r._localTransform=new e,r._worldTranslation=null,r._worldRotation=null,r._worldScale=null,r._anchorPoint={x:0,y:0},n&&n.addChild(r),r.on(Y.type,function(t){t.addObject(r,r.z,r.worldTransform)}),r.on(q.type,function(t){var e=r.boundingShape;t.result=!!e&&x(e,{x:t.x,y:t.y})}),r.on(vt.type,function(t){switch(t.propName){case"z":t.propValue=r.z,t.eat();break;case"visible":t.propValue=r.visible,t.eat();break;case"transform":t.propValue=r.localTransform,t.eat();break;case"translation":var e=r.translation;t.propValue=[e.x,e.y],t.eat();break;case"scale":t.propValue=[e.x,e.y],t.eat();break;case"rotation":t.propValue=r.rotation,t.eat();break;case"anchorPoint":t.propValue=r.anchorPoint,t.eat()}}),r.on(mt.type,function(t){switch(t.propName){case"z":r.z=t.propValue,t.eat();break;case"visible":r.visible=t.propValue,t.eat();break;case"transform":r.localTransform=t.propValue,t.eat();break;case"translation":var e=t.propValue;r.translation={x:Math.round(e[0]),y:Math.round(e[1])};break;case"scale":var n=t.propValue;r.scale={x:n[0],y:n[1]};break;case"rotation":r.rotation=t.propValue;break;case"anchorPoint":r.anchorPoint=t.propValue}}),r}return F(n,t),Object.defineProperty(n.prototype,"boundingShape",{get:function(){var t=new G;return this.triggerEx(t),t.shape||null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"view",{get:function(){return this._view},set:function(t){this._view=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"z",{get:function(){return this._z},set:function(t){this.setZ(t)},enumerable:!0,configurable:!0}),n.prototype.setZ=function(t){this._z=t},Object.defineProperty(n.prototype,"visible",{get:function(){return this._visible},set:function(t){this.setVisible(t)},enumerable:!0,configurable:!0}),n.prototype.setVisible=function(t){this._visible=t},Object.defineProperty(n.prototype,"localTransform",{get:function(){return this._localTransform},set:function(t){this.setLocalTransform(t)},enumerable:!0,configurable:!0}),n.prototype.setLocalTransform=function(t){this._localTransform=t},Object.defineProperty(n.prototype,"translation",{get:function(){return this.localTransform.getTranslationPart()},set:function(t){this.setTranslation(t)},enumerable:!0,configurable:!0}),n.prototype.setTranslation=function(t){this.localTransform.setTranslationPart(t)},Object.defineProperty(n.prototype,"scale",{get:function(){return this.localTransform.getScalePart()},set:function(t){this.setScale(t)},enumerable:!0,configurable:!0}),n.prototype.setScale=function(t){this.localTransform.setScalePart(t)},Object.defineProperty(n.prototype,"rotation",{get:function(){return this.localTransform.getRotationPart()},set:function(t){this.setRotation(t)},enumerable:!0,configurable:!0}),n.prototype.setRotation=function(t){this.localTransform.setRotationPart(t)},Object.defineProperty(n.prototype,"worldTransform",{get:function(){var t=this.parent?e.transform(this.parent.worldTransform,this.localTransform):this.localTransform;return null!==this._worldTranslation&&t.setTranslationPart(this._worldTranslation),null!==this._worldRotation&&t.setRotationPart(this._worldRotation),null!==this._worldScale&&t.setScalePart(this._worldScale),t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"worldTranslation",{get:function(){return this._worldTranslation},set:function(t){this.setWorldTranslation(t)},enumerable:!0,configurable:!0}),n.prototype.setWorldTranslation=function(t){this._worldTranslation=null===t?null:{x:Math.round(t.x),y:Math.round(t.y)}},Object.defineProperty(n.prototype,"worldRotation",{get:function(){return this._worldRotation},set:function(t){this.setWorldRotation(t)},enumerable:!0,configurable:!0}),n.prototype.setWorldRotation=function(t){this._worldRotation=t},Object.defineProperty(n.prototype,"worldScale",{get:function(){return this._worldScale},set:function(t){this.setWorldScale(t)},enumerable:!0,configurable:!0}),n.prototype.setWorldScale=function(t){this._worldScale=t},Object.defineProperty(n.prototype,"anchorPoint",{get:function(){return this._anchorPoint},set:function(t){this.setAnchorPoint(t)},enumerable:!0,configurable:!0}),n.prototype.setAnchorPoint=function(t){this._anchorPoint=t},Object.defineProperty(n.prototype,"numChildren",{get:function(){return this._children.length},enumerable:!0,configurable:!0}),n.prototype.collapseTransform=function(){var t=this.worldTransform;this.worldTranslation=null,this.worldRotation=null,this.worldScale=null,this.parent?this.localTransform=e.invert(this.parent.worldTransform).transform(t):this.localTransform=t,this.localTransform.e=Math.round(this.localTransform.e),this.localTransform.f=Math.round(this.localTransform.f)},n.prototype.getLocalPoint=function(t,n){return e.invert(this.worldTransform).transformPoint({x:t,y:n})},n.prototype.childAt=function(t){return this._children[t]},n.prototype.forEachChild=function(t){this._children.forEach(t)},n.prototype.addChild=function(t){null===t._parent&&(t._parent=this,t._view=this._view,this._children.push(t))},n.prototype.removeChild=function(t){if(t._parent===this){var e=this._children.indexOf(t);this.removeChildAt(e)}},n.prototype.removeChildAt=function(t){if(t>=0&&t<this._children.length){var e=this._children[t];this._children.splice(t,1),e._parent=null,e._view=null}},n.prototype.removeChildren=function(){for(;this._children.length>0;)this.removeChildAt(0)},n.prototype.unrefChildren=function(){for(;this._children.length>0;)this._children[0].unrefChildren(),this.removeChildAt(0)},n.prototype.remove=function(){this._parent&&this._parent.removeChild(this)},n.prototype.triggerRecursive=function(e){t.prototype.trigger.call(this,e),this.forEachChild(function(t,n){t.triggerRecursive(e)})},n.prototype.triggerRecursiveEx=function(e){t.prototype.triggerEx.call(this,e),this.forEachChild(function(t,n){t.triggerRecursiveEx(e)})},n.prototype.setCapture=function(){this._view&&this._view.setCaptureObject(this)},n.prototype.releaseCapture=function(){this._view&&this._view.captureObject===this&&this._view.setCaptureObject(null)},n.prototype.toString=function(){return"<SceneObject>"},n}(Ot),Et=function(t){function n(n,r){void 0===r&&(r=!1);var i=t.call(this)||this;i._canvas=new Ct(i,n,r),i._captureObject=null,i._hitObjects=[],i._currentPage=null,i._pages={};var o=new Tt;return o.view=i,i.addPage({name:"page1",rootNode:o,bkImageUrl:null,bkImageRepeat:null,bkImageSize:null,bkImageAttachment:null,bkColor:"#ffffff"}),i.selectPage("page1"),i.on(Q.type,function(t){var n=new W(t.deltaTime,t.elapsedTime,t.frameStamp);i.rootNode&&i.rootNode.triggerRecursiveEx(n),i.canvas.clear(),i.triggerEx(new X(i.canvas,0,new e)),i.canvas.flip()}),i.on(X.type,function(t){if(i.rootNode){var e=new Y(t.canvas.width,t.canvas.height);for(var n in i.rootNode.triggerRecursiveEx(e),e.result)for(var r=e.result[n],o=0;o<r.length;o++)t.canvas.context.save(),t.canvas.applyTransform(r[o].transform),t.canvas.context.translate(.5,.5),r[o].object.triggerEx(new X(t.canvas,r[o].z,r[o].transform)),t.canvas.context.restore()}}),i}return F(n,t),n.prototype.forEachPage=function(t){if(t)for(var e in this._pages)t({name:e,rootNode:this._pages[e].rootNode,bkImageUrl:this._pages[e].bkImageUrl,bkImageRepeat:this._pages[e].bkImageRepeat,bkImageAttachment:this._pages[e].bkImageAttachment,bkImageSize:this._pages[e].bkImageSize,bkColor:this._pages[e].bkColor})},n.prototype.addPage=function(t){var e={name:null,rootNode:null,bkImageUrl:null,bkImageRepeat:"repeat",bkImageAttachment:"scroll",bkImageSize:"auto",bkColor:"#ffffff"},n=t||e,r=n.name||this.genPageName();return r in this._pages?null:(this._pages[r]={name:r,rootNode:n.rootNode,bkImageUrl:n.bkImageUrl,bkImageRepeat:n.bkImageRepeat||e.bkImageRepeat,bkImageAttachment:n.bkImageAttachment||e.bkImageAttachment,bkImageSize:n.bkImageSize||e.bkImageSize,bkColor:n.bkColor||e.bkColor},r)},n.prototype.removePage=function(t){if(t in this._pages){if(t===this._currentPage){var e=!1;for(var n in this._pages)n!==t&&(this.selectPage(n),e=!0);if(!e)return!1}return this._pages[t].rootNode.unrefChildren(),this._pages[t].rootNode.view=null,this._pages[t].rootNode=null,delete this._pages[t],!0}return!1},n.prototype.selectPage=function(t){var e=this._currentPage;t in this._pages&&t!==e&&(xt.triggerEvent(null,new bt(this,e,t)),this._currentPage=t,this._captureObject=null,this._hitObjects.length=0,this.applyPage(this._pages[this._currentPage]),xt.triggerEvent(null,new _t(this,e,t)))},n.prototype.renamePage=function(t,e){if(t in this._pages&&e&&e!==t&&!(e in this._pages)){var n=this._pages[t];delete this._pages[t],n.name=e,this._pages[e]=n}},Object.defineProperty(n.prototype,"currentPage",{get:function(){return this._currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageImage",{get:function(){return this._pages[this._currentPage].bkImageUrl},set:function(t){t!==this._pages[this._currentPage].bkImageUrl&&(this._pages[this._currentPage].bkImageUrl=t,this.applyPage(this._pages[this._currentPage]))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageImageRepeat",{get:function(){return this._pages[this._currentPage].bkImageRepeat},set:function(t){var e=t||"repeat";e!==this._pages[this._currentPage].bkImageRepeat&&(this._pages[this._currentPage].bkImageRepeat=e,this.applyPage(this._pages[this._currentPage]))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageImageAttachment",{get:function(){return this._pages[this._currentPage].bkImageAttachment},set:function(t){var e=t||"scroll";e!==this._pages[this._currentPage].bkImageAttachment&&(this._pages[this._currentPage].bkImageAttachment=e,this.applyPage(this._pages[this._currentPage]))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageImageSize",{get:function(){return this._pages[this._currentPage].bkImageSize},set:function(t){var e=t||"auto";e!==this._pages[this._currentPage].bkImageSize&&(this._pages[this._currentPage].bkImageSize=e,this.applyPage(this._pages[this._currentPage]))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageColor",{get:function(){return this._pages[this._currentPage].bkColor},set:function(t){t!==this._pages[this._currentPage].bkColor&&(this._pages[this._currentPage].bkColor=t,this.applyPage(this._pages[this._currentPage]))},enumerable:!0,configurable:!0}),n.prototype.updateHitObjects=function(t,e){for(var n=this.hitTest(t,e),r=0;r<this._hitObjects.length;)n.indexOf(this._hitObjects[r])<0?(this._hitObjects[r].trigger(new at),this._hitObjects.splice(r,1)):r++;for(r=0;r<n.length;r++)this._hitObjects.indexOf(n[r])<0&&n[r].trigger(new st);this._hitObjects=n,this._hitObjects.push(this.rootNode)},Object.defineProperty(n.prototype,"rootNode",{get:function(){return this._pages[this._currentPage].rootNode},set:function(t){this._pages[this._currentPage].rootNode!==t&&(this._pages[this._currentPage].rootNode=t,this._hitObjects.length=0,this._captureObject=null)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"captureObject",{get:function(){return this._captureObject},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hitObjects",{get:function(){return this._hitObjects},enumerable:!0,configurable:!0}),n.prototype.setCaptureObject=function(t){this._captureObject=t},n.prototype.handleMouseDown=function(t){var e=this.canvas.viewport_rect,n=new rt(t.clientX-e.x,t.clientY-e.y,t.button,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey);if(this.isValidObject(this._captureObject))this._captureObject.triggerEx(n);else{for(var r=0;r<this._hitObjects.length;r++){var i=this._hitObjects[r];if(this.isValidObject(i)&&(i.triggerEx(n),!n.bubble))break}n.bubble&&this.triggerEx(n)}},n.prototype.handleMouseUp=function(t){var e=this.canvas.viewport_rect,n=new it(t.clientX-e.x,t.clientY-e.y,t.button,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey);if(this.isValidObject(this._captureObject))this._captureObject.triggerEx(n);else{for(var r=0;r<this._hitObjects.length;r++){var i=this._hitObjects[r];if(this.isValidObject(i)&&(i.triggerEx(n),!n.bubble))break}n.bubble&&this.triggerEx(n)}},n.prototype.handleMouseMove=function(t){var e=this.canvas.viewport_rect,n=new ot(t.clientX-e.x,t.clientY-e.y,t.button,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey);if(this.isValidObject(this._captureObject))this._captureObject.triggerEx(n);else{for(var r=0;r<this._hitObjects.length;r++){var i=this._hitObjects[r];if(this.isValidObject(i)&&(i.triggerEx(n),!n.bubble))break}n.bubble&&this.triggerEx(n)}},n.prototype.handleClick=function(t){for(var e=this.canvas.viewport_rect,n=new ct(t.clientX-e.x,t.clientY-e.y,t.button,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey),r=0;r<this._hitObjects.length;r++){var i=this._hitObjects[r];if(this.isValidObject(i)&&(i.triggerEx(n),!n.bubble))break}n.bubble&&this.triggerEx(n)},n.prototype.handleDblClick=function(t){for(var e=this.canvas.viewport_rect,n=new ut(t.clientX-e.x,t.clientY-e.y,t.button,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey),r=0;r<this._hitObjects.length;r++){var i=this._hitObjects[r];if(this.isValidObject(i)&&(i.triggerEx(n),!n.bubble))break}n.bubble&&this.triggerEx(n)},n.prototype.setFocus=function(){xt.setFocusView(this)},n.prototype.hitTest=function(t,n){var r=[];return this.rootNode&&(!function r(i,o){var s=e.invert(i.worldTransform).transformPoint({x:t,y:n}),a=new q(s.x,s.y);i.triggerEx(a),a.result&&o.push(i),i.forEachChild(function(t,e){r(t,o)})}(this.rootNode,r),r.sort(function(t,e){return e.z-t.z})),r},n.prototype.isValidObject=function(t){return t&&t.view===this},n.prototype.genPageName=function(){for(var t=1;;){var e="page"+t++;if(!(e in this._pages))return e}},n.prototype.applyPage=function(t){var e=t.bkColor||"",n=t.bkImageUrl&&"url("+t.bkImageUrl+")"||"",r=t.bkImageRepeat||"repeat",i=t.bkImageAttachment||"scroll",o=t.bkImageSize||"auto";this._canvas.canvas.style.background=e+" "+n+" "+r+" "+i+" 0% 0% / "+o},n}(Ot);function jt(t,e){var n=parseInt(window.getComputedStyle(t).zIndex,10);isNaN(n)&&(n=0),n--;var r=document.createElement("div");r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style.right="0px",r.style.bottom="0px",r.style.overflow="hidden",r.style.zIndex=String(n),r.style.visibility="hidden";var i=document.createElement("div");i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style.width="10000000px",i.style.height="10000000px",r.appendChild(i);var o=document.createElement("div");o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.right="0px",o.style.bottom="0px",o.style.overflow="hidden",o.style.zIndex=String(n),o.style.visibility="hidden";var s=document.createElement("div");function a(){r.scrollLeft=1e7,r.scrollTop=1e7,o.scrollLeft=1e7,o.scrollTop=1e7}s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.width="200%",s.style.height="200%",o.appendChild(s),t.appendChild(r),t.appendChild(o),a();var c=t.getBoundingClientRect(),u=c.width,h=c.height,l=function(){var n=t.getBoundingClientRect(),r=n.width,i=n.height;r===u&&i===h||(u=r,h=i,e()),a()};r.addEventListener("scroll",l),o.addEventListener("scroll",l)}var St,Ct=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this)||this;return i._view=e,i._canvas=n,i._canvas&&(i.adjustCanvasSize(i._canvas),jt(i._canvas.parentElement,function(){i.adjustCanvasSize(i._canvas)})),i._mouseOver=!1,i._doubleBuffer=r,i}return F(e,t),Object.defineProperty(e.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._doubleBuffer?this._offscreenCtx:this._screenCtx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewport_rect",{get:function(){var t=this._canvas.getBoundingClientRect();return{x:t.left-document.documentElement.clientLeft,y:t.top-document.documentElement.clientTop,w:t.right-t.left,h:t.bottom-t.top}},enumerable:!0,configurable:!0}),e.prototype.clear=function(t){var e=t?t.x:0,n=t?t.y:0,r=t?t.w:this._width,i=t?t.h:this._height;this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(e,n,r,i),this._doubleBuffer&&this._screenCtx.clearRect(e,n,r,i)},e.prototype.applyTransform=function(t){this.context.setTransform(t.a,t.b,t.c,t.d,Math.round(t.e),Math.round(t.f))},e.prototype.flip=function(){this._doubleBuffer&&this._screenCtx.drawImage(this._buffer,0,0)},e.prototype.adjustCanvasSize=function(t){var e=window.getComputedStyle(t.parentElement);this._width=t.parentElement.clientWidth-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight),this._height=t.parentElement.clientHeight-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom),this._canvas.width=this._width,this._canvas.height=this._height,this._screenCtx=this._canvas.getContext("2d"),this._buffer=document.createElement("canvas"),this._buffer.width=this._width,this._buffer.height=this._height,this._offscreenCtx=this._buffer.getContext("2d"),xt.triggerEvent(null,new dt(this._view))},e}(Ot),It=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();(St=t.SplineType||(t.SplineType={}))[St.STEP=1]="STEP",St[St.LINEAR=2]="LINEAR",St[St.POLY=3]="POLY";var Dt,Mt=function(){function t(t,e){void 0===e&&(e=!1),this.cp=t,this.clamp=e}return t.prototype.eval=function(t){return 0},t.prototype.evalFirst=function(){return this.cp.length>0?this.cp[0].y:0},t.prototype.evalLast=function(){return this.cp.length>0?this.cp[this.cp.length-1].y:0},t}(),Lt=function(t){function e(e,n){void 0===n&&(n=!1);var r=t.call(this,e,n)||this;return r.h=new Array(e.length-1),r.compute(),r}return It(e,t),e.prototype.compute=function(){for(var t=0;t<this.cp.length-1;++t)this.h[t]=this.cp[t+1].x-this.cp[t].x},e.prototype.getSegment=function(t){var e;for(e=0;e<this.cp.length-1&&!(t<this.cp[e+1].x);e++);return e},e.prototype.eval=function(t){if(this.clamp){if(t<0)return this.cp[0].y;if(t>this.cp[this.cp.length-1].x)return this.cp[this.cp.length-1].y}var e=this.getSegment(t);return this.cp[e].y},e}(Mt),Vt=function(t){function e(e,n){void 0===n&&(n=!1);var r=t.call(this,e,n)||this;return r.h=new Array(e.length-1),r.cp=e,r.compute(),r}return It(e,t),e.prototype.compute=function(){for(var t=0;t<this.cp.length-1;++t)this.h[t]=this.cp[t+1].x-this.cp[t].x},e.prototype.getSegment=function(t){var e;for(e=0;e<this.cp.length-1&&!(t<this.cp[e+1].x);e++);return e===this.cp.length-1&&e--,e},e.prototype.eval=function(t){if(this.clamp){if(t<0)return this.cp[0].y;if(t>this.cp[this.cp.length-1].x)return this.cp[this.cp.length-1].y}var e=this.getSegment(t),n=t-this.cp[e].x;return this.cp[e].y+(this.cp[e+1].y-this.cp[e].y)*n/this.h[e]},e}(Mt),Kt=function(t){function e(e,n){void 0===n&&(n=!1);var r=t.call(this,e,n)||this;return r.a=new Array(e.length),r.h=new Array(e.length),r.cp=e,r.compute(),r}return It(e,t),e.prototype.solveTridiag=function(t,e,n){for(var r=this.cp.length-2,i=2;i<=r;i++)t[i]/=e[i-1],e[i]-=t[i]*n[i-1],this.a[i]-=this.a[i-1]*t[i];this.a[r]/=e[r];for(i=r-1;i>=1;--i)this.a[i]=(this.a[i]-this.a[i+1]*n[i])/e[i]},e.prototype.compute=function(){var t=this.cp.length,e=new Array(t-1),n=new Array(t-1),r=new Array(t-1);this.a[0]=0,this.a[t-1]=0;for(var i=1;i<t;++i)this.h[i]=this.cp[i].x-this.cp[i-1].x;for(i=1;i<t-1;++i)n[i]=(this.h[i]+this.h[i+1])/3,r[i]=this.h[i+1]/6,e[i]=this.h[i]/6,this.a[i]=(this.cp[i+1].y-this.cp[i].y)/this.h[i+1]-(this.cp[i].y-this.cp[i-1].y)/this.h[i];this.solveTridiag(e,n,r)},e.prototype.getSegment=function(t){var e;for(e=0;e<this.cp.length-1&&!(t<this.cp[e+1].x);e++);return e===this.cp.length-1&&e--,e},e.prototype.eval=function(t){if(this.clamp){if(t<0)return this.cp[0].y;if(t>this.cp[this.cp.length-1].x)return this.cp[this.cp.length-1].y}var e=this.getSegment(t)+1,n=t-this.cp[e-1].x,r=this.h[e]-n;return((-this.a[e-1]/6*(r+this.h[e])*n+this.cp[e-1].y)*r+(-this.a[e]/6*(n+this.h[e])*r+this.cp[e].y)*n)/this.h[e]},e}(Mt),At=function(){function e(t,e,n){void 0===n&&(n=!1),this._evalutors=[],this._array=!1,e.length>0&&("number"==typeof e[0].y?this.initNonArray(t,e,n):this.initArray(t,e,n))}return e.prototype.eval=function(t){if(this._evalutors.length>0){if(this._array){var e=[];return this._evalutors.forEach(function(n){e.push(n.eval(t))}),e}return this._evalutors[0].eval(t)}return 0},e.prototype.evalFirst=function(){if(this._evalutors.length>0){if(this._array){var t=[];return this._evalutors.forEach(function(e){t.push(e.evalFirst())}),t}return this._evalutors[0].evalFirst()}return 0},e.prototype.evalLast=function(){if(this._evalutors.length>0){if(this._array){var t=[];return this._evalutors.forEach(function(e){t.push(e.evalLast())}),t}return this._evalutors[0].evalLast()}return 0},e.prototype.initArray=function(e,n,r){var i=n[0].y.length;if(i>0){for(var o=0;o<i;o++){for(var s=[],a=0;a<n.length;a++){var c=n[a].y.length>o?n[a].y[o]:0;s.push({x:n[a].x,y:c})}switch(e){case t.SplineType.STEP:this._evalutors.push(new Lt(s,r));break;case t.SplineType.LINEAR:this._evalutors.push(new Vt(s,r));break;case t.SplineType.POLY:default:this._evalutors.push(new Kt(s,r))}}this._array=!0}},e.prototype.initNonArray=function(e,n,r){switch(e){case t.SplineType.STEP:this._evalutors.push(new Lt(n,r));break;case t.SplineType.LINEAR:this._evalutors.push(new Vt(n,r));break;case t.SplineType.POLY:default:this._evalutors.push(new Kt(n,r))}this._array=!1},e}();(Dt=t.KeyCode||(t.KeyCode={}))[Dt.kBackspace=8]="kBackspace",Dt[Dt.kTab=9]="kTab",Dt[Dt.kClear=12]="kClear",Dt[Dt.kEnter=13]="kEnter",Dt[Dt.kShift=16]="kShift",Dt[Dt.kControl=17]="kControl",Dt[Dt.kAlt=18]="kAlt",Dt[Dt.kPause=19]="kPause",Dt[Dt.kCapsLock=20]="kCapsLock",Dt[Dt.kEscape=27]="kEscape",Dt[Dt.kSpace=32]="kSpace",Dt[Dt.kPageUp=33]="kPageUp",Dt[Dt.kPageDown=34]="kPageDown",Dt[Dt.kEnd=35]="kEnd",Dt[Dt.kHome=36]="kHome",Dt[Dt.kLeft=37]="kLeft",Dt[Dt.kUp=38]="kUp",Dt[Dt.kRight=39]="kRight",Dt[Dt.kDown=40]="kDown",Dt[Dt.kSelect=41]="kSelect",Dt[Dt.kPrint=42]="kPrint",Dt[Dt.kExecute=43]="kExecute",Dt[Dt.kInsert=45]="kInsert",Dt[Dt.kDelete=46]="kDelete",Dt[Dt.kHelp=47]="kHelp",Dt[Dt.k0=48]="k0",Dt[Dt.k1=49]="k1",Dt[Dt.k2=50]="k2",Dt[Dt.k3=51]="k3",Dt[Dt.k4=52]="k4",Dt[Dt.k5=53]="k5",Dt[Dt.k6=54]="k6",Dt[Dt.k7=55]="k7",Dt[Dt.k8=56]="k8",Dt[Dt.k9=57]="k9",Dt[Dt.kA=65]="kA",Dt[Dt.kB=66]="kB",Dt[Dt.kC=67]="kC",Dt[Dt.kD=68]="kD",Dt[Dt.kE=69]="kE",Dt[Dt.kF=70]="kF",Dt[Dt.kG=71]="kG",Dt[Dt.kH=72]="kH",Dt[Dt.kI=73]="kI",Dt[Dt.kJ=74]="kJ",Dt[Dt.kK=75]="kK",Dt[Dt.kL=76]="kL",Dt[Dt.kM=77]="kM",Dt[Dt.kN=78]="kN",Dt[Dt.kO=79]="kO",Dt[Dt.kP=80]="kP",Dt[Dt.kQ=81]="kQ",Dt[Dt.kR=82]="kR",Dt[Dt.kS=83]="kS",Dt[Dt.kT=84]="kT",Dt[Dt.kU=85]="kU",Dt[Dt.kV=86]="kV",Dt[Dt.kW=87]="kW",Dt[Dt.kX=88]="kX",Dt[Dt.kY=89]="kY",Dt[Dt.kZ=90]="kZ",Dt[Dt.kLeftMeta=91]="kLeftMeta",Dt[Dt.kRightMeta=92]="kRightMeta",Dt[Dt.kMenu=93]="kMenu",Dt[Dt.kKP0=96]="kKP0",Dt[Dt.kKP1=97]="kKP1",Dt[Dt.kKP2=98]="kKP2",Dt[Dt.kKP3=99]="kKP3",Dt[Dt.kKP4=100]="kKP4",Dt[Dt.kKP5=101]="kKP5",Dt[Dt.kKP6=102]="kKP6",Dt[Dt.kKP7=103]="kKP7",Dt[Dt.kKP8=104]="kKP8",Dt[Dt.kKP9=105]="kKP9",Dt[Dt.kKPMul=106]="kKPMul",Dt[Dt.kKPAdd=107]="kKPAdd",Dt[Dt.kKPSep=108]="kKPSep",Dt[Dt.kKPSub=109]="kKPSub",Dt[Dt.kKPDec=110]="kKPDec",Dt[Dt.kKPDiv=111]="kKPDiv",Dt[Dt.kF1=112]="kF1",Dt[Dt.kF2=113]="kF2",Dt[Dt.kF3=114]="kF3",Dt[Dt.kF4=115]="kF4",Dt[Dt.kF5=116]="kF5",Dt[Dt.kF6=117]="kF6",Dt[Dt.kF7=118]="kF7",Dt[Dt.kF8=119]="kF8",Dt[Dt.kF9=120]="kF9",Dt[Dt.kF10=121]="kF10",Dt[Dt.kF11=122]="kF11",Dt[Dt.kF12=123]="kF12",Dt[Dt.kNumLock=144]="kNumLock",Dt[Dt.kScrollLock=145]="kScrollLock",Dt[Dt.kAdd=187]="kAdd",Dt[Dt.kComma=188]="kComma",Dt[Dt.kMinus=189]="kMinus",Dt[Dt.kPeriod=190]="kPeriod",Dt[Dt.kApostrophe=192]="kApostrophe",Dt[Dt.kLeftBrace=219]="kLeftBrace",Dt[Dt.kRightBrace=221]="kRightBrace",Dt[Dt.kBackSlash=220]="kBackSlash",Dt[Dt.kQuot=222]="kQuot",Dt[Dt.kSemicolon=186]="kSemicolon",Dt[Dt.kSlash=191]="kSlash";var Rt=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ft=function(e){function n(r){var i=e.call(this,n.type)||this;i._tracks={},i._duration=0,i._startTime=0,i._round=0;var o=r||{};if(i._delay=void 0===o.delay?0:o.delay,i._repeat=void 0===o.repeat?0:o.repeat,i._autoRemove=void 0===o.autoRemove||o.autoRemove,i._exclusive=!!o.exclusive,o.tracks)for(var s in o.tracks)if(o.tracks.hasOwnProperty(s)){var a=o.tracks[s],c=void 0===a.type?t.SplineType.POLY:a.type,u=void 0===a.clamp||a.clamp;i.setTrack(s,c,u,a.cp)}return i.on(z.type,function(t){i._exclusive&&t.object.removeComponentsByType(i.type)}),i.on(W.type,function(t){var e=t.elapsedTime;if(0===i._startTime&&(i._startTime=e),!(i._startTime+i._delay>e)){var n=e-i._startTime-i._delay;for(var r in i._tracks)i._tracks.hasOwnProperty(r)&&(i._tracks[r].value=i._tracks[r].evalutor.eval(n));if(i.object)for(var o in i._tracks)i._tracks.hasOwnProperty(o)&&i.object.triggerEx(new mt(o,i._tracks[o].value));n>=i._duration&&(i._round++,0===i._repeat||i._round<i._repeat?i._startTime=e+n-i._duration:i._autoRemove&&i.object.removeComponent(i))}}),i}return Rt(n,e),Object.defineProperty(n.prototype,"repeat",{get:function(){return this._repeat},set:function(t){this._repeat=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"autoRemove",{get:function(){return this._autoRemove},set:function(t){this._autoRemove=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"delay",{get:function(){return this._delay},set:function(t){this._delay=t},enumerable:!0,configurable:!0}),n.prototype.setTrack=function(t,e,n,r){r.length>0&&(r[r.length-1].x>this._duration&&(this._duration=r[r.length-1].x),this._tracks[t]={evalutor:new At(e,r,n),value:null})},n.prototype.finish=function(){for(var t in this._tracks)this._tracks[t].value=this._tracks[t].evalutor.evalLast();if(this.object)for(var e in this._tracks)this.object.triggerEx(new mt(e,this._tracks[e].value));this._round++,0===this._repeat||this._round<this._repeat?this._startTime=xt.elapsedTime:this._autoRemove&&this.object.removeComponent(this)},n.type="KeyframeAnimation",n}(Pt),Bt=function(t){function e(){var n=t.call(this,e.type)||this;return n._dragging=!1,n._draggingData=null,n.on(rt.type,function(t){var e=n.object;e.setCapture(),n._dragging=!0;var r=new ht(t.x,t.y,t.button,t.shiftDown,t.altDown,t.ctrlDown,t.metaDown);e.triggerEx(r),n._draggingData=r.data,t.cancelBubble()}),n.on(it.type,function(t){var e=n.object;if(e.releaseCapture(),n._dragging){var r=new lt(t.x,t.y,t.button,t.shiftDown,t.altDown,t.ctrlDown,t.metaDown,n._draggingData);e.triggerEx(r),n._dragging=!1,e.view.updateHitObjects(t.x,t.y);for(var i=new gt(t.x,t.y,t.button,t.shiftDown,t.altDown,t.ctrlDown,t.metaDown,e,n._draggingData),o=0;o<e.view.hitObjects.length;o++){var s=e.view.hitObjects[o];if(s!==e&&s.z<=e.z&&(s.triggerEx(i),!i.bubble))break}i.bubble&&e.view.triggerEx(i),n._draggingData=null,t.cancelBubble()}}),n.on(ot.type,function(t){if(n._dragging){var e=new pt(t.x,t.y,t.button,t.shiftDown,t.altDown,t.ctrlDown,t.metaDown,n._draggingData);n.object.triggerEx(e);var r=n.object;r.view.updateHitObjects(t.x,t.y);for(var i=new ft(t.x,t.y,t.button,t.shiftDown,t.altDown,t.ctrlDown,t.metaDown,r,n._draggingData),o=0;o<r.view.hitObjects.length;o++){var s=r.view.hitObjects[o];if(s!==r&&s.z<=r.z&&(s.triggerEx(i),!i.bubble))break}i.bubble&&r.view.triggerEx(i),t.cancelBubble()}}),n}return Rt(e,t),e.type="Draggable",e}(Pt),zt=function(t){function e(){return t.call(this,e.type)||this}return Rt(e,t),e.type="Droppable",e}(Pt),Nt=function(t){function e(n,r,i){void 0===n&&(n=null),void 0===r&&(r=0),void 0===i&&(i=0);var o=t.call(this,e.type)||this;return o._image=new Image,n&&(o._image.src=n),r?(o._image.width=r,o._width=r):o._width=o._image.complete?o._image.width:0,i?(o._image.height=i,o._height=i):o._height=o._image.complete?o._image.height:0,o._image.complete?o._loaded=!0:(o._loaded=!1,o._image.onload=function(){0===o._width&&(o._width=o._image.width),0===o._height&&(o._height=o._image.height),o._loaded=!0}),o.on(Y.type,function(t){if(o._loaded){var e=o.object;t.addObject(o,e.z,e.worldTransform)}}),o.on(G.type,function(t){o._loaded&&(t.shape=new m({x:-o._width*o.object.anchorPoint.x,y:-o._height*o.object.anchorPoint.y,w:o._width,h:o._height}))}),o.on(X.type,function(t){o._loaded&&t.canvas.context.drawImage(o._image,-Math.round(o._width*o.object.anchorPoint.x)-.5,-Math.round(o._height*o.object.anchorPoint.y)-.5,o._width,o._height)}),o.on(vt.type,function(t){switch(t.propName){case"width":t.propValue=o._width,t.eat();break;case"height":t.propValue=o._height,t.eat()}}),o.on(mt.type,function(t){switch(t.propName){case"width":o._width=t.propValue,o._image.width=o._width,t.eat();break;case"height":o._height=t.propValue,o._image.height=o._height,t.eat()}}),o}return Rt(e,t),e.type="Image",e}(Pt);function Ht(t,e,n,r,i,o,s,a){var c=4*(i*e+r);t[c]=o,t[c+1]=s,t[c+2]=a,t[c+3]=255}var Ut=null;function Wt(t){for(var e={r:255,g:255,b:255,a:255},n=[],r=0,i=(t.toLowerCase(),"0".charCodeAt(0)),o="9".charCodeAt(0),s="a".charCodeAt(0),a="f".charCodeAt(0),c=1;c<t.length;c++){var u=t.charCodeAt(c),h=0;u>=i&&u<=o?h=u-i:u>=s&&u<=a&&(h=10+u-s),c%2==1?r=h:n.push(16*r+h)}return n.length>0&&(e.r=n[0]),n.length>1&&(e.g=n[1]),n.length>2&&(e.b=n[2]),n.length>3&&(e.a=n[3]),e}var Yt=[],Xt=!1;function qt(){Xt=!0,document.removeEventListener("DOMContentLoaded",qt),window.removeEventListener("load",qt),xt.run(),Yt.forEach(function(t){t()}),Yt.length=0}"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(qt):(document.addEventListener("DOMContentLoaded",qt),window.addEventListener("load",qt)),t.ready=function(t){t&&(Xt?window.setTimeout(t):Yt.push(t))},t.GetTopLeft=n,t.GetTopRight=r,t.GetBottomLeft=i,t.GetBottomRight=o,t.Normalize=function(t){var e=a(t);e>1e-4&&(t.x/=e,t.y/=e)},t.VectorLengthSq=s,t.VectorLength=a,t.DistanceSq=c,t.Distance=function(t,e){return a(l(t,e))},t.DotProduct=u,t.CrossProduct=h,t.GetVector=l,t.ClampPoint=p,t.BoundingShape=g,t.BoundingBox=m,t.BoundingHull=d,t.BoundingSegment=_,t.BoundingSphere=w,t.IntersectionTestShapeSegment=function(t,e){if(t.getBoundingbox())switch(t.type){case m.type:return E(t.rect,e);case d.type:return M(t.points,e);case _.type:var n=A(t.segment,e);return n?[n]:[];case w.type:return D(t.sphere,e)}return null},t.IntersectionTestShapeBox=function(t,e){if(!t.getBoundingbox())return!1;switch(t.type){case m.type:return P(t.rect,e);case d.type:return T(e,t.points);case _.type:return null!=E(e,t.segment);case w.type:return j(e,t.sphere);default:return!1}},t.IntersectionTestShapeHull=function(t,e){if(!t.getBoundingbox())return!1;switch(t.type){case m.type:return T(t.rect,e);case d.type:return L(t.points,e);case _.type:return null!=M(e,t.segment);case w.type:return S(t.sphere,e);default:return!1}},t.IntersectionTestShapePoint=x,t.IntersectionTestShapeShape=function(t,e){if(!P(t.getBoundingbox(),e.getBoundingbox()))return!1;switch(t.type){case m.type:switch(e.type){case m.type:return!0;case d.type:return T(t.rect,e.points);case _.type:return null!=E(t.rect,e.segment);case w.type:return j(t.rect,e.sphere);default:return!1}case d.type:switch(e.type){case m.type:return T(e.rect,t.points);case d.type:return L(t.points,e.points);case _.type:return null!=M(t.points,e.segment);case w.type:return S(e.sphere,t.points);default:return!1}case _.type:switch(e.type){case m.type:return null!=E(e.rect,t.segment);case d.type:return null!=M(e.points,t.segment);case _.type:return null!=A(e.segment,t.segment);case w.type:return null!=D(e.sphere,t.segment);default:return!1}case w.type:switch(e.type){case m.type:return j(e.rect,t.sphere);case d.type:return S(t.sphere,e.points);case _.type:return null!=D(t.sphere,e.segment);case w.type:return I(t.sphere,e.sphere);default:return!1}}},t.IntersectionTestBoxBox=P,t.IntersectionTestBoxPoint=O,t.IntersectionTestBoxHull=T,t.IntersectionTestBoxSegment=E,t.IntersectionTestBoxSphere=j,t.IntersectionTestSphereHull=S,t.IntersectionTestHullPoint=C,t.IntersectionTestSphereSphere=I,t.IntersectionTestSphereSegment=D,t.IntersectionTestHullSegment=M,t.IntersectionTestHullHull=L,t.IntersectionTestSpherePoint=V,t.IntersectionTestSegmentPoint=K,t.IntersectionTestSegmentSegment=A,t.CurveEvaluter=Mt,t.StepEvaluter=Lt,t.CoLinearEvaluter=Vt,t.PolynomialsEvaluter=Kt,t.Spline=At,t.Matrix2d=e,t.BaseEvent=B,t.EvtComponentBeforeAttach=z,t.EvtComponentAttached=N,t.EvtComponentBeforeDetach=H,t.EvtComponentDetached=U,t.EvtUpdate=W,t.EvtCull=Y,t.EvtDraw=X,t.EvtHitTest=q,t.EvtGetBoundingShape=G,t.EvtFrame=Q,t.EvtFocus=Z,t.EvtKeyboard=J,t.EvtKeyDown=$,t.EvtKeyUp=tt,t.EvtKeyPress=et,t.EvtMouse=nt,t.EvtMouseDown=rt,t.EvtMouseUp=it,t.EvtMouseMove=ot,t.EvtMouseEnter=st,t.EvtMouseLeave=at,t.EvtClick=ct,t.EvtDblClick=ut,t.EvtDragBegin=ht,t.EvtDragEnd=lt,t.EvtDragging=pt,t.EvtDragOver=ft,t.EvtDragDrop=gt,t.EvtResize=yt,t.EvtCanvasResize=dt,t.EvtGetProp=vt,t.EvtSetProp=mt,t.EvtSceneViewPageWillChange=bt,t.EvtSceneViewPageChanged=_t,t.EvtSysInfo=kt,t.EventObserver=wt,t.App=xt,t.Component=Pt,t.BaseObject=Ot,t.SceneObject=Tt,t.SceneView=Et,t.ResizeSensor=jt,t.Canvas=Ct,t.CoKeyframeAnimation=Ft,t.CoDraggable=Bt,t.CoDroppable=zt,t.CoImage=Nt,t.DrawLine=function(t,e,n,r,i,o){var s=Wt(o),a=e>r?r:e,c=n>i?i:n,u=e>r?e:r,h=n>i?n:i,l=t.getImageData(a,c,u-a+1,h-c+1);!function(t,e,n,r,i,o,s,a,c,u){var h,l=Math.abs(o-r),p=Math.abs(s-i),f=0;l<p&&(f=1,h=r,r=i,i=h,h=o,o=s,s=h,h=l,l=p,p=h);var g=o>r?1:-1,y=s>i?1:-1,d=r,v=i,m=2*p,b=2*(p-l),_=2*p-l;if(1===f)for(;d!==o;)_<0?_+=m:(v+=y,_+=b),Ht(t,e,0,v,d,a,c,u),d+=g;else for(;d!==o;)_<0?_+=m:(v+=y,_+=b),Ht(t,e,0,d,v,a,c,u),d+=g}(l.data,l.width,l.height,e-a,n-c,r-a,i-c,s.r,s.g,s.b),t.putImageData(l,a,c)},t.FillCircle=function(t,e,n,r,i){var o=Wt(i),s=t.getImageData(e-r,n-r,2*r+1,2*r+1);!function(t,e,n,r,i,o,s,a,c){function u(t,n){var u=t-r,h=n-i,l=1-Math.sqrt((u*u+h*h)/(o*o)),p=4*(n*e+t);Ut[p]=s*l,Ut[p+1]=a*l,Ut[p+2]=c*l,Ut[p+3]=255*l}(null===Ut||Ut.length<t.length)&&(Ut=new Uint8ClampedArray(t.length));var h,l=0,p=o,f=3,g=2-o-o,y=1-o;for(u(l+r,p+i),u(l+r,-p+i),h=-o+r;h<=o+r;h++)u(h,i);for(;l<p;){for(y<0?(y+=f,f+=2,l++):(y+=f+g,f+=2,g+=2,l++,p--),h=-l+r;h<=l+r;h++)u(h,-p+i),u(h,p+i);for(h=-p+r;h<=p+r;h++)u(h,-l+i),u(h,l+i)}!function(t,e){for(var n=0;n<t.length/4;n++){var r=1-e[4*n+3]/255;t[4*n]=t[4*n]*r+e[4*n],t[4*n+1]=t[4*n+1]*r+e[4*n+1],t[4*n+2]=t[4*n+2]*r+e[4*n+2],t[4*n+3]<e[4*n+3]&&(t[4*n+3]=e[4*n+3])}}(t,Ut)}(s.data,s.width,s.height,r,r,r,o.r,o.g,o.b),t.putImageData(s,e-r,n-r)},Object.defineProperty(t,"__esModule",{value:!0})});
